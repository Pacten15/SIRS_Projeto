How to setup Database:

postgresSQL version: 16.1

inicializar o postgres no kali:

sudo systemctl start postgresql

inicializar o postgres sempre que arrancar com o kali:

sudo systemctl enable postgresql

Instalação da librarie de python que consegue manipular base de dados postgresSQL

pip3 install psycopg2


Como criar uma base de dados:

	initizializar o postgres:

	sudo su postgres

	psql
	
	CREATE USER luis WITH PASSWORD '123';

	CREATE DATABASE documents WITH OWNER luis ENCODING='UTF8' LC_COLLATE='pt_PT.utf8' LC_CTYPE='pt_PT.utf8' TEMPLATE=template0;

Passar luis para super user

ALTER luis TO SUPERUSER



Alterar a linguagem reconhecida pelo servidor, para português já que a imagem do kali instalada vem com o inglês americano e quando fosse para enfiar os documentos na base de dados poderia haver problemas associados a por exemplo ao 'ç' entre outros caracteres.

sudo localedef -i pt_PT -f UTF-8 pt_PT.UTF-8


Uma alternativa ao comando anterior é inserir manualmente o Locale no arquivo /etc/locale.conf adicionando a seguinte diretiva ao arquivo:

    LANG=pt_PT.UTF-8


Procurar o port para usar no código python:

SHOW port;

Listar todas as bases de dados:

\l


Port que todos podem usar para aceder à base de dados:

host    all             all             127.0.0.1/32            scram-sha-256


Aceder a Local Database:

sudo su postgres

psql

\c documents


Ver a tabela da base de dados:

SELECT * FROM json_documents;


Devido à forma como criei a base de dados a unica forma de aceder a ela por intermédio do terminal é preciso fazer o seguinte:

sudo su postgres

psql -U postgres -d documents -W 

digita a password: postgres

E tens acesso à db diretamente, no entanto para modificações na tabela já é preciso as credenciais do user criado.


Para alterar as configurações de rede da database hosted basta fazer:

sudo nano /etc/postgresql/16/main/pg_hba.conf

Alterar este ficheiro trocando o address do postgres com o address de uma das vm(por testar) por baixo do ultimo host.

host    all             all             192.168.0.10/24         md5

alterar o ficheiro postgres.conf

sudo nano /etc/postgresql/16/main/postgres.conf

Substiutir a linha

#listen_addresses = 'localhost'

para

listen_addresses = '192.168.0.10'

Asseguir fazer restart da db

sudo su postgres

systemctl restart postgres








Ordem de Execução dos ficheiro .py da database

1º database.py 

2º AddJsonFile.py


	